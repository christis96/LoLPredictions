<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Summoner Stats</title>
</head>
<body>
    <div id="app"></div>
    
    <script>
        // MODEL
        const model = {
            page: "summoners", 
            input: {
                name: "",
                winRate: "",
                gamesPlayed: "",
                level: "",
                rank: "",
                csPerMin: ""
            },
            data: {
                lastGamesSummoners:{
                    avgWinrate: "",
                    avgKDA: "",


                },

                
                summoners: [
                    { 
                        name: "Player1", 
                        winRate: 55, 
                        gamesPlayed: 200, 
                        level: 150, 
                        rank: "Platinum 3", 
                        csPerMin: 7.5, 
                        games: [
                            { outcome: "Win", kills: 10, deaths: 3, assists: 5, cs: 150, gameDuration: 20 },
                            { outcome: "Loss", kills: 7, deaths: 5, assists: 8, cs: 120, gameDuration: 22 },
                            { outcome: "Win", kills: 12, deaths: 2, assists: 9, cs: 160, gameDuration: 18 },
                            { outcome: "Loss", kills: 6, deaths: 6, assists: 4, cs: 130, gameDuration: 25 },
                            { outcome: "Win", kills: 14, deaths: 5, assists: 7, cs: 140, gameDuration: 20 },
                            { outcome: "Win", kills: 9, deaths: 4, assists: 6, cs: 145, gameDuration: 19 },
                            { outcome: "Loss", kills: 5, deaths: 7, assists: 8, cs: 110, gameDuration: 23 },
                            { outcome: "Win", kills: 11, deaths: 3, assists: 10, cs: 150, gameDuration: 21 },
                            { outcome: "Loss", kills: 8, deaths: 6, assists: 5, cs: 120, gameDuration: 20 },
                            { outcome: "Win", kills: 10, deaths: 2, assists: 11, cs: 160, gameDuration: 18 }
                        ]
                    },
                    { 
                        name: "Player2", 
                        winRate: 48, 
                        gamesPlayed: 300, 
                        level: 120, 
                        rank: "Gold 2",
                        csPerMin: 6.8, 
                        games: [
                            { outcome: "Loss", kills: 5, deaths: 2, assists: 10, cs: 140, gameDuration: 23 },
                            { outcome: "Win", kills: 6, deaths: 4, assists: 9, cs: 150, gameDuration: 20 },
                            { outcome: "Loss", kills: 7, deaths: 6, assists: 5, cs: 130, gameDuration: 25 },
                            { outcome: "Win", kills: 10, deaths: 3, assists: 7, cs: 160, gameDuration: 22 },
                            { outcome: "Win", kills: 8, deaths: 5, assists: 12, cs: 140, gameDuration: 21 },
                            { outcome: "Loss", kills: 4, deaths: 7, assists: 6, cs: 110, gameDuration: 26 },
                            { outcome: "Win", kills: 11, deaths: 2, assists: 10, cs: 150, gameDuration: 20 },
                            { outcome: "Loss", kills: 9, deaths: 6, assists: 8, cs: 120, gameDuration: 24 },
                            { outcome: "Win", kills: 7, deaths: 4, assists: 5, cs: 135, gameDuration: 22 },
                            { outcome: "Loss", kills: 6, deaths: 3, assists: 9, cs: 140, gameDuration: 20 }
                        ]
                    },
                    { 
                        name: "Faker", 
                        winRate: 65, 
                        gamesPlayed: 800, 
                        level: 250, 
                        rank: "Challenger 1000 LP", 
                        csPerMin: 8.4, 
                        games: [
                            { outcome: "Win", kills: 15, deaths: 2, assists: 10, cs: 180, gameDuration: 20 },
                            { outcome: "Win", kills: 12, deaths: 1, assists: 8, cs: 160, gameDuration: 18 },
                            { outcome: "Win", kills: 18, deaths: 3, assists: 12, cs: 200, gameDuration: 22 },
                            { outcome: "Win", kills: 14, deaths: 2, assists: 7, cs: 175, gameDuration: 20 },
                            { outcome: "Win", kills: 16, deaths: 1, assists: 9, cs: 190, gameDuration: 21 },
                            { outcome: "Win", kills: 13, deaths: 3, assists: 11, cs: 170, gameDuration: 19 },
                            { outcome: "Loss", kills: 10, deaths: 5, assists: 6, cs: 160, gameDuration: 22 },
                            { outcome: "Win", kills: 20, deaths: 2, assists: 14, cs: 210, gameDuration: 20 },
                            { outcome: "Win", kills: 17, deaths: 4, assists: 9, cs: 180, gameDuration: 19 },
                            { outcome: "Win", kills: 14, deaths: 1, assists: 10, cs: 160, gameDuration: 18 }
                        ]
                    },
                    { 
                        name: "Dopa", 
                        winRate: 70, 
                        gamesPlayed: 900, 
                        level: 280, 
                        rank: "Challenger 1200 LP",
                        csPerMin: 9.2, 
                        games: [
                            { outcome: "Win", kills: 20, deaths: 1, assists: 12, cs: 220, gameDuration: 24 },
                            { outcome: "Win", kills: 18, deaths: 2, assists: 10, cs: 210, gameDuration: 23 },
                            { outcome: "Win", kills: 25, deaths: 3, assists: 15, cs: 240, gameDuration: 26 },
                            { outcome: "Win", kills: 22, deaths: 1, assists: 11, cs: 230, gameDuration: 25 },
                            { outcome: "Win", kills: 19, deaths: 2, assists: 13, cs: 220, gameDuration: 24 },
                            { outcome: "Win", kills: 21, deaths: 3, assists: 14, cs: 230, gameDuration: 22 },
                            { outcome: "Win", kills: 23, deaths: 1, assists: 16, cs: 240, gameDuration: 23 },
                            { outcome: "Loss", kills: 17, deaths: 5, assists: 9, cs: 180, gameDuration: 24 },
                            { outcome: "Win", kills: 26, deaths: 2, assists: 14, cs: 250, gameDuration: 25 },
                            { outcome: "Win", kills: 24, deaths: 3, assists: 12, cs: 230, gameDuration: 23 }
                        ]
                    }
                ]
            }
        };
        //VIEW
        updateView();
        function updateView(){
            const app = document.getElementById("app");
            let html = '<button onclick="changePage(\'summoners\')">Summoners</button>';
            html += '<button onclick="changePage(\'Avg stats\')">Avg stats</button>';
            
            switch(model.page) {
                case "summoners":
                    html += "<h2>Summoners:</h2><ul>";
                    for(let summoner of model.data.summoners){
                        html += `<li><strong>${summoner.name}</strong> - WR: ${summoner.winRate}% | Games: ${summoner.gamesPlayed} | Level: ${summoner.level} | Rank: ${summoner.rank}
                            <ul>`;
                        for(let game of summoner.games){
                            html += `<li>${game.outcome} - K/D/A: ${game.kills}/${game.deaths}/${game.assists}</li>`;
                        }
                        html += "</ul></li>";
                    }
                    html += "</ul>";
                    break;
                
                    case "Avg stats":
                        html += `<h2>Avg stats</h2>`;
                        html += `<h3>Summoner stats last 10 games:</h3>`;
    
                        for (let summoner of model.data.summoners) {
                            let stats = getGameAvgStats(summoner);
                            html += `<h3>${summoner.name}</h3>
                                    <p>Average Winrate: ${stats.avgWinrate}%</p>
                                    <p>Average KDA: ${stats.avgKDA}</p>
                                    <p>Average CS per Minute: ${stats.avgCSPerMin}</p>`;
                                    
                        }
                        break;
            }
            app.innerHTML = html;
        }

        function changePage(page) {
            model.page = page;
            updateView();
        }
        
        //CONTROLLER
        
        function getGameAvgStats(summoner) {
            let totalWins = 0;
            let totalKills = 0;
            let totalDeaths = 0;
            let totalAssists = 0;
            let totalCS = 0; 
            let totalDuration = 0; 
            let totalGames = summoner.games.length;

            for (let game of summoner.games) {
                if (game.outcome === "Win") totalWins++;
                    totalKills += game.kills;
                    totalDeaths += game.deaths;
                    totalAssists += game.assists;
                    totalCS += game.cs; 
                    totalDuration += game.gameDuration; 
            }

            let avgWinrate = ((totalWins / totalGames) * 100).toFixed(2);
            let avgKDA = ((totalKills + totalAssists) / Math.max(1, totalDeaths)).toFixed(2);
            let avgCSPerMin = (totalCS / totalDuration).toFixed(2); 

            model.data.lastGamesSummoners.avgWinrate = avgWinrate;
            model.data.lastGamesSummoners.avgKDA = avgKDA;
            model.data.lastGamesSummoners.avgCSPerMin = avgCSPerMin; 

            return { avgWinrate, avgKDA, avgCSPerMin }; 
        }
        function getRankChange(){
            //her skal en sjekke for endringer i rank over antall games, og returnere om en har gått opp, ned eller stagnert
            return null;
        }

        function getChanceOfWin(){
            //her skal en gjøre en sannsynlighetsberegning på utfallet av game'et basert på stats(hvet ikke hvilke stats ennå)
            return null;
        }

        function compareStats(arr){
            //her skal jeg ta inn et array for å gjøre sammenligninger med ulike summoners for å se omm det er en sammenheng med noe
            return null;
        }

        
    
    </script>
</body>
</html>
